<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Pull Request Size Labeling Workflow &#8212; Base Shift 0.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=686e5160" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=27fed22d" />
    <script src="../_static/documentation_options.js?v=7026087e"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Functional Flow" href="../functional_flow.html" />
    <link rel="prev" title="Build and Deploy Sphinx Docs" href="deploy_application_docs.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="pull-request-size-labeling-workflow">
<h1>Pull Request Size Labeling Workflow<a class="headerlink" href="#pull-request-size-labeling-workflow" title="Link to this heading">¶</a></h1>
<p>This document outlines the rationale, structure, and implementation details of the GitHub Actions workflow designed to automatically label pull requests (PRs) based on the size of changes they introduce.</p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">¶</a></h2>
<p>As our project scales, the volume and complexity of contributions will increase, making it essential to streamline the code review process. One effective way to do this is by automatically labeling PRs based on their size. This labeling provides immediate insight into the scope of a PR, enabling reviewers to prioritize and allocate their time more effectively.</p>
<p>The workflow described here automatically categorizes PRs into four sizes: <cite>small</cite>, <cite>medium</cite>, <cite>large</cite>, and <cite>extra-large</cite>. These categories are based on the number of lines of code (LOC) changed, which is a reasonable proxy for the complexity and review effort required.</p>
</section>
<section id="implementation-details">
<h2>Implementation Details<a class="headerlink" href="#implementation-details" title="Link to this heading">¶</a></h2>
<p><strong>Triggering Events:</strong>
The workflow is triggered on the following pull request events:
- <cite>opened</cite>: When a new PR is created.
- <cite>synchronize</cite>: When new commits are pushed to an existing PR.
- <cite>reopened</cite>: When a closed PR is reopened.</p>
<p>These events ensure that the label is always up-to-date with the latest changes.</p>
<p><strong>Steps Involved:</strong></p>
<ol class="arabic">
<li><p><strong>Checkout Code:</strong>
The first step involves checking out the code from the pull request. This allows the workflow to analyze the changes introduced in the PR.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Checkout code</span>
<span class="w">  </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions/checkout@v3</span>
</pre></div>
</div>
</li>
<li><p><strong>Calculate Lines of Code:</strong>
The next step calculates the total number of lines changed in the PR. This is done using <cite>git diff</cite>, which compares the PR branch with the base branch (typically <cite>main</cite>). The result is stored as an environment variable for subsequent steps.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Calculate lines of code</span>
<span class="w">  </span><span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">diff</span>
<span class="w">  </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">    </span><span class="no">LOC=$(git diff --shortstat origin/main...HEAD | awk &#39;{print $1}&#39;)</span>
<span class="w">    </span><span class="no">echo &quot;lines_of_code=$LOC&quot; &gt;&gt; $GITHUB_ENV</span>
</pre></div>
</div>
</li>
<li><p><strong>Determine PR Size:</strong>
Based on the calculated LOC, the workflow determines the size category of the PR. The thresholds are as follows:</p>
<ul class="simple">
<li><p><cite>small</cite>: Less than 10 lines changed.</p></li>
<li><p><cite>medium</cite>: Between 10 and 49 lines changed.</p></li>
<li><p><cite>large</cite>: Between 50 and 99 lines changed.</p></li>
<li><p><cite>extra-large</cite>: 100 lines or more changed.</p></li>
</ul>
<p>These thresholds are carefully chosen to balance between being overly granular and too broad.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Set PR size label</span>
<span class="w">  </span><span class="nt">if</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">env.lines_of_code != &#39;&#39;</span>
<span class="w">  </span><span class="nt">run</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">    </span><span class="no">echo &quot;Lines of code changed: ${{ env.lines_of_code }}&quot;</span>

<span class="w">    </span><span class="no">if [ ${{ env.lines_of_code }} -lt 10 ]; then</span>
<span class="w">      </span><span class="no">echo &quot;PR size is small&quot;</span>
<span class="w">      </span><span class="no">echo &quot;small&quot; &gt; size.txt</span>
<span class="w">    </span><span class="no">elif [ ${{ env.lines_of_code }} -lt 50 ]; then</span>
<span class="w">      </span><span class="no">echo &quot;PR size is medium&quot;</span>
<span class="w">      </span><span class="no">echo &quot;medium&quot; &gt; size.txt</span>
<span class="w">    </span><span class="no">elif [ ${{ env.lines_of_code }} -lt 100 ]; then</span>
<span class="w">      </span><span class="no">echo &quot;PR size is large&quot;</span>
<span class="w">      </span><span class="no">echo &quot;large&quot; &gt; size.txt</span>
<span class="w">    </span><span class="no">else</span>
<span class="w">      </span><span class="no">echo &quot;PR size is extra-large&quot;</span>
<span class="w">      </span><span class="no">echo &quot;extra-large&quot; &gt; size.txt</span>
<span class="w">    </span><span class="no">fi</span>
<span class="w">    </span><span class="no">PR_LABEL=$(cat size.txt)</span>
<span class="w">    </span><span class="no">echo &quot;pr-label=$PR_LABEL&quot; &gt;&gt; $GITHUB_ENV</span>
</pre></div>
</div>
</li>
<li><p><strong>Apply the Label:</strong>
Finally, the workflow applies the determined size label to the PR using the <cite>actions-ecosystem/action-add-labels</cite> action. This ensures that the PR is appropriately categorized in the GitHub UI, facilitating quicker and more effective review processes.</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Apply label to PR</span>
<span class="w">  </span><span class="nt">uses</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">actions-ecosystem/action-add-labels@v1</span>
<span class="w">  </span><span class="nt">with</span><span class="p">:</span>
<span class="w">    </span><span class="nt">github_token</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ secrets.GITHUB_TOKEN }}</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${{ env.pr-label }}</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="benefits-and-considerations">
<h2>Benefits and Considerations<a class="headerlink" href="#benefits-and-considerations" title="Link to this heading">¶</a></h2>
<p><strong>Benefits:</strong>
- <strong>Enhanced Review Efficiency:</strong> Reviewers can quickly gauge the size and complexity of a PR, allowing for better prioritization.
- <strong>Automated Consistency:</strong> Labels are applied consistently without manual intervention, reducing human error.
- <strong>Scalability:</strong> As the project grows, this workflow will continue to provide value by standardizing the review process.</p>
<p><strong>Considerations:</strong>
- <strong>Thresholds Customization:</strong> The thresholds for PR size can be adjusted to better fit the team’s needs. Teams with different coding practices might find different thresholds more appropriate.
- <strong>Base Branch Configuration:</strong> Ensure that the base branch (<cite>origin/main</cite> in this case) is correctly configured. This may need to be adjusted depending on the branching strategy used.</p>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">¶</a></h2>
<p>This PR size labeling workflow is a crucial component of our CI/CD pipeline, designed to improve code review efficiency and maintain high standards of code quality. By automating this task, we reduce the cognitive load on developers and allow them to focus on the content of the code rather than administrative overhead.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Base Shift</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../system_architecture.html">System Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functional_flow.html">Functional Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../industry_needs_target.html">Industry Needs and Target Market</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup_tools.html">Setup Tools and Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribution_guide.html">Contribution Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../versioning.html">Versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../components.html">System Architecture Breakdown</a></li>
<li class="toctree-l1"><a class="reference internal" href="../additional_information.html">Additional Information</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../system_architecture.html">System Architecture</a><ul>
      <li>Previous: <a href="deploy_application_docs.html" title="previous chapter">Build and Deploy Sphinx Docs</a></li>
      <li>Next: <a href="../functional_flow.html" title="next chapter">Functional Flow</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Gaurav Mishra.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.1.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/workflows/pr_size_label.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>